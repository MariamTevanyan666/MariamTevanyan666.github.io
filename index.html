<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title> Մարիամ Թևանյան Դիպլոմային</title>
<style>
th {	
background-color: darkseagreen; }
#inputs {
width: 25%;
text-align: center; }
input {
margin-top: 10px; }
table {
border-spacing: 0; }
th, td { 
border: 1px solid dimgray;
padding: 10px; }
.button {
background-color: #99B299;
border: outset;
color: white;
padding: 20px 30px;
text-decoration: none;
text-align: center;
text-decoration: none;
display: inline;
font-size: 30px;
margin: 15px 0; }
.inserted {
background: darkkhaki; }
#table1, #table2, #table3 {
margin-top: 30px;
width: 70%; }
#table3 {
display: none; }
</style>
<title>Մարիամ Թևանյան Դիպլոմային</title>
</head>
<body>
<div id="inputs">
</div>
</div>
<input type="number" id ='Միջին տարեկան ֆոնդ (Հազար դրամ)' 
placeholder="Միջին տարեկան ֆոնդ">
</div>
<button class="button" onclick="newData()">A B C</button>
</div>
<div id="table1"> 
</div>
<input type="number" id='I Եռամսյակ' placeholder="I Եռամսյակ ">
</div>
<input type="number" id='II Եռամսյակ' placeholder="II Եռամսյակ ">
</div>
<input type="number" id='III Եռամսյակ' placeholder="III Եռամսյակ ">
</div>
<input type="number" id='IV Եռամսյակ' placeholder="IV Եռամսյակ ">
</div>
<button class="button" onclick="newData1()">X Y Z</button>
</div>
<div id="table2"></div>
</div>
<button class="button" onclick="newData2()">A B C_X Y Z</button>
</div>
<div id="table3">
<table>
<tr>
<td></td>
<td>X</td>
<td>Y</td>
<td>Z</td>
</tr>
<tr>
<td>A</td>
<td id="AX" class="numberField"></td>
<td id="AY" class="numberField"></td>
<td id="AZ" class="numberField"></td>
</tr>
<tr>
<td>B</td>
<td id="BX" class="numberField"></td>
<td id="BY" class="numberField"></td>
<td id="BZ" class="numberField"></td>
</tr>
<tr>
<td>C</td>
<td id="CX" class="numberField"></td>
<td id="CY" class="numberField"></td>
<td id="CZ" class="numberField"></td>
</tr>
</table>
</div>
<script>
let startData = [
['1',2214,590,614,690,670],['2',714,200,114,180,114],['3',3514,500,1140,414,690],['4',814,170,190,214,190],['5',90,20,0,50,40],['6',1514,514,540,414,430],['7',220,40,50,50,70],['8',16140,4400,4500,4140,4140],['9',310,50,60,114,40],['10',5214,1010,1030,1140,960],['11',8714,2214,2180,2280,2214],['12',1914,514,550,530,560],['13',914,214,270,280,250],['14',414,70,114,80,60],['15',414,100,80,60,80],['16',214,90,60,80,50],['17',114,60,30,60,50],['18',114,60,20,40,10],['19',714,190,114,130,50],['20',80,30,50,0,30],['21',214,60,50,50,70],['22',814,190,200,214,180],['23',30,0,40,5,10],['24',170,40,60,40,70],['25',3014,590,714,660,800],['26',110,40,40,50,30],['27',23140,5140,5500,5490,5850],['28',40,10,0,20,10],['29',280,50,30,70,50],['30',914,240,314,414,240],['31',20,5,10,15,10],['32',70,10,70,20,20],['33',370,80,40,50,70],['34',13140,2900,3140,3314,3214],['35',614,90,114,170,114],['36',50,15,30,30,15],['37',520,90,80,114,90],['38',6140,1770,850,560,2140],['39',140,20,30,80,40],['40',9814,2614,2514,2714,2314],['41',450,90,80,60,90],['42',990,314,330,314,314],['43',1314,300,550,390,570],['44',580,100,114,90,114],['45',690,114,180,150,190],['46',890,150,240,240,214],['47',1714,514,580,414,470],['48',60,25,25,40,20],['49',7140,1500,2200,1600,1800],['50',1140,290,314,350,390]  ]
let insertedColumn = 0;
let columns = ['Ապրանքատեսակի համար','Միջին տարեկան ֆոնդ (Հազար դրամ)','I Եռամսյակ','II Եռամսյակ','III Եռամսյակ','IV Եռամսյակ', 'Տոկոսային Մաս (%)', 'Տոկոսային Մասնաբաժին (%)', 'Խումբ']
let showColumns = ['Ապրանքատեսակի համար','Միջին տարեկան ֆոնդ (Հազար դրամ)', 'Տոկոսային Մաս (%)', 'Տոկոսային Մասնաբաժին (%)', 'Խումբ']
let insertedColumn1 = 0;
let columns1 = ['Ապրանքատեսակի համար','I Եռամսյակ','II Եռամսյակ','III Եռամսյակ','IV Եռամսյակ','Միջին','Միջին քառակուսային','Վարիացիայի գարծակից (%)','Խումբ']
let showColumns1 = ['Ապրանքատեսակի համար','I Եռամսյակ','II Եռամսյակ','III Եռամսյակ','IV Եռամսյակ','Միջին','Միջին քառակուսային','Վարիացիայի գարծակից (%)','Խումբ']                    
let columns2 = ['Ապրանքատեսակի համար','I Եռամսյակ','II Եռամսյակ','III Եռամսյակ','IV Եռամսյակ','Միջին','Միջին քառակուսային','Վարիացիայի գործակից(%)','Խումբ']
let showColumns2 = ['Ապրանքատեսակի համար', 'Խումբ']
const dataToObject = (data) => {
return data.map((elem) => {
return { ...elem.reduce((obj, el, i) => {
obj[columns[i]] = el
return obj
}, {} )}  })  }
const sortData = (elem) => {
return JSON.parse(JSON.stringify(elem)).sort(function(a, b){
return b[columns[1]] - a[columns[1]];})  }
const sortData1 = (elem) => {
return JSON.parse(JSON.stringify(elem)).sort(function(a, b){
return a[columns1[7]] - b[columns1[7]]; })  }
const sortData2 = (elem) => {
return JSON.parse(JSON.stringify(elem)).sort(function(a, b) {
return a[columns1[0]] - b[columns1[0]]   })  }
const percentFunction = (elem) => {
const percent = JSON.parse(JSON.stringify(elem)).reduce((p, d) => {
return p + d[columns[1]]    }, 0)
const array = JSON.parse(JSON.stringify(elem)).map((elem) => {
elem[columns[6]] = elem[columns[1]] * 100 / percent;
return elem;   })
return array.map((data, i) => {i === 0 ? data[columns[7]] = data[columns[6]]: 
data[columns[7]] = array[i-1][columns[7]] + data[columns[6]]
data[columns[8]] = data[columns[7]] < 80 ? 'A':
data[columns[7]] < 95 ? 'B': 'C'
return data  })    }
const percentFunction1 = (elem) => {
const percent = JSON.parse(JSON.stringify(elem)).reduce((p, d) => {
return p + d[columns1[1]]   }, 0)
const array = JSON.parse(JSON.stringify(elem)).map((elem) => {
elem[columns1[6]] = elem[columns1[1]] * 100 / percent;
return elem;  })
return array.map((data) => {
data[columns1[5]] = (data[columns1[1]] + data[columns1[2]] + 
data[columns1[3]] + data[columns1[4]])/4
data[columns1[6]] = Math.sqrt(( Math.pow(data[columns1[1]]- data[columns1[5]], 2) + Math.pow(data[columns1[2]]- data[columns1[5]], 2) + Math.pow(data[columns1[3]]- data[columns1[5]], 2) + Math.pow(data[columns1[4]]- data[columns1[5]], 2))/ 3)
data[columns1[7]] = data[columns1[6]] / data[columns1[5]] * 100
data[columns1[8]] = data[columns1[7]] <= 10 ? 'X' : 
data[columns1[7]] <= 25 ? 'Y' : 'Z'
return data  }) }
const createTable = (rows) =>  {
let html = '<table>';
html += '<tr>';
for( let j of showColumns ) {
html += '<th>' + j + '</th>';  }
html += '</tr>';
for( let i = 0; i < rows.length; i++) {
html += insertedColumn && insertedColumn === rows[i]['Ապրանքատեսակի համար'] ? '<tr class="inserted">': '<tr>';
for( let j of showColumns ) {
html += '<td>' + rows[i][j] + '</td>';  }
html += '</tr>'; }
html += '</table>';
document.getElementById('table1').innerHTML = html;  }
const createTable1 = (rows) =>  {
let html = '<table>';
html += '<tr>';
for( let j of showColumns1 ) {
html += '<th>' + j + '</th>'; }
html += '</tr>';
for( let i = 0; i < rows.length; i++) {
html += insertedColumn1 && insertedColumn1=== rows[i]['Ապրանքատեսակի համար'] ? '<tr class="inserted">': '<tr>';
for( let j of showColumns1 ) {
html += '<td>' + rows[i][j] + '</td>';  }
html += '</tr>';  }
html += '</table>';
document.getElementById('table2').innerHTML = html; }            
const start = () => {
startData= sortData(startData)
startData = percentFunction(startData)
createTable(startData) }
const start1 = () => {
startData1 = percentFunction1(startData1)
startData1 = sortData1(startData1)
createTable1(startData1)  }
startData = dataToObject(startData)
let startData1 = JSON.parse(JSON.stringify(startData));
start()
start1()
const newData = () => {
const obj = {'Միջին տարեկան ֆոնդ (Հազար դրամ)' : +document.getElementById('Միջին տարեկան ֆոնդ (Հազար դրամ)').value}
const condition = Object.values(obj).filter(elem => elem === '')
if (!condition.length) {
insertedColumn = startData.length + 1
startData.push({...obj, 'Ապրանքատեսակի համար': insertedColumn})
start() }} 
const newData1 = () => {
const quarter1 = Number(document.getElementById('I Եռամսյակ').value)
const quarter2 = Number(document.getElementById('II Եռամսյակ').value)
const quarter3 = Number(document.getElementById('III Եռամսյակ').value)
const quarter4 = Number(document.getElementById('IV Եռամսյակ').value)
const avg =  (quarter1 + quarter2 + quarter3 +quarter4) / 4
const sqrAvg = Math.sqrt((Math.pow(quarter1 - avg, 2) + Math.pow(quarter2 - avg, 2) + Math.pow(quarter3 - avg, 2) + Math.pow(quarter4 - avg, 2)) / 3)
const variation = sqrAvg / avg * 100
const group = variation <= 10 ? 'X' : variation <= 25 ? 'Y' : 'Z'
const obj = {
'I Եռամսյակ': quarter1,
'II Եռամսյակ': quarter2,
'III Եռամսյակ': quarter3,
'IV Եռամսյակ': quarter4,
'Միջին': avg,
'Միջին քառակուսային': sqrAvg,
'Վարիացիայի գործակից (%)': variation,
'Խումբ': group   }
const condition = Object.values(obj).filter(elem => elem === '')
if (!condition.length) { 
insertedColumn1 = startData1.length + 1
startData1.push({...obj, 'Ապրանքատեսակի համար': insertedColumn1})
start1() } }
const newData2 = () => {
document.getElementById('table3').style.display = "block"
var fields = document.querySelectorAll("#table3 table tr .numberField");
fields.forEach(td => {
td.innerHTML = ""; });
let rows = sortData2(startData)
let rows1 = sortData2(startData1)
for( let i = 0; i < rows.length; i++) {
for( let j of showColumns2 ) {
if (j !== 'Ապրանքատեսակի համար' && rows1[i]) {
document.getElementById(`${rows[i][j] + rows1[i][j]}`).innerHTML += ` ${i+1}`
} } }  }
</script>
</body>
</html>
